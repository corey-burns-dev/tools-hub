---
// ThemeToggle.astro - Dark/Light mode toggle
---

<button
  id="theme-toggle"
  class="btn-bouncy bg-linear-to-r from-blue-500 to-purple-500 text-white hover:from-blue-600 hover:to-purple-600 dark:from-purple-600 dark:to-blue-600"
  aria-label="Toggle dark mode"
>
  <span id="theme-icon">ðŸŒ™</span>
</button>

<script>
  const initTheme = () => {
    const themeToggle = document.getElementById("theme-toggle");
    const themeIcon = document.getElementById("theme-icon");
    const htmlElement = document.documentElement;

    if (!themeToggle || !themeIcon) return;

    const setTheme = (isDark: boolean) => {
      htmlElement.classList.toggle("dark", isDark);
      localStorage.setItem("theme", isDark ? "dark" : "light");
      themeIcon.textContent = isDark ? "â˜€ï¸" : "ðŸŒ™";
    };

    const savedTheme = localStorage.getItem("theme") || "light";
    setTheme(savedTheme === "dark");

    themeToggle.addEventListener("click", () => {
      const nextIsDark = !htmlElement.classList.contains("dark");
      setTheme(nextIsDark);
    });
  };

  // Run on load, handle hydration
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initTheme);
  } else {
    initTheme();
  }
</script>
