---
import Button from "@/components/ui/Button.astro";
import ToolCard from "@/components/ui/ToolCard.astro";
import ToolGrid from "@/components/ui/ToolGrid.astro";
import ToolPage from "@/components/ui/ToolPage.astro";
import Layout from "../layouts/Layout.astro";
---

<Layout title="Username Generator">
  <ToolPage description="Create unique, aesthetic, and professional identities in seconds.">
    <ToolGrid cols={3} class="gap-8">
      <!-- Controls -->
      <div class="lg:col-span-1">
        <ToolCard title="Configuration" step="01.">
          <div class="space-y-6">
            <div class="space-y-2">
              <label for="base-word" class="block text-sm font-medium text-slate-400"
                >Base Word (Optional)</label
              >
              <input type="text" id="base-word" placeholder="e.g. Dragon" class="w-full" />
            </div>

            <div class="space-y-3">
              <label class="block text-sm font-medium text-slate-400">Category</label>
              <div class="grid grid-cols-2 gap-2">
                <Button variant="primary" size="sm" class="category-btn" data-category="all">
                  All
                </Button>
                <Button variant="secondary" size="sm" class="category-btn" data-category="gaming">
                  Gaming
                </Button>
                <Button
                  variant="secondary"
                  size="sm"
                  class="category-btn"
                  data-category="aesthetic"
                >
                  Aesthetic
                </Button>
                <Button variant="secondary" size="sm" class="category-btn" data-category="funny">
                  Funny
                </Button>
              </div>
            </div>

            <div class="space-y-3">
              <label class="block text-sm font-medium text-slate-400">Options</label>
              <label
                class="flex cursor-pointer items-center gap-3 rounded-lg border border-white/5 bg-black/20 p-3 transition-all hover:bg-white/5 active:bg-black/30"
              >
                <input
                  type="checkbox"
                  id="use-numbers"
                  checked
                  class="h-4 w-4 rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"
                />
                <span class="text-sm text-slate-300">Include Numbers</span>
              </label>
            </div>

            <div class="pt-2">
              <Button id="generate-btn" variant="primary" class="w-full"> âš¡ Generate </Button>
            </div>
          </div>
        </ToolCard>
      </div>

      <!-- Results -->
      <div class="lg:col-span-2">
        <ToolCard title="Your Identities" step="02.">
          <div slot="header-actions">
            <div
              class="rounded-full border border-blue-500/20 bg-blue-500/10 px-3 py-1 text-[10px] font-bold tracking-tighter text-blue-400 uppercase"
            >
              Click to copy
            </div>
          </div>

          <div
            id="results-grid"
            class="grid min-h-[400px] grid-cols-1 content-start gap-3 sm:grid-cols-2"
          >
            <!-- Results will be injected here -->
            <div
              class="flex h-full flex-col items-center justify-center py-20 text-slate-500 opacity-30 sm:col-span-2"
            >
              <div class="mb-4 text-5xl">ðŸ‘¤</div>
              <p class="text-xs font-bold tracking-widest uppercase">Ready to generate usernames</p>
            </div>
          </div>
        </ToolCard>
      </div>
    </ToolGrid>
  </ToolPage>
</Layout>

<script>
  // Generator Logic
  const adjectives = [
    "Cyber",
    "Neon",
    "Techno",
    "Shadow",
    "Solar",
    "Lunar",
    "Cosmic",
    "Pixel",
    "Glitch",
    "Retro",
    "Hyper",
    "Mega",
    "Ultra",
    "Super",
    "Quantum",
    "Astro",
    "Turbo",
    "Rapid",
    "Sonic",
    "Vapor",
    "Dark",
    "Light",
    "Frost",
    "Iron",
    "Steel",
    "Titan",
    "Ghost",
    "Phantom",
    "Spirit",
    "Soul",
    "Magic",
    "Mystic",
    "Crystal",
    "Diamond",
    "Ruby",
    "Emerald",
    "Sapphire",
    "Golden",
    "Silver",
    "Bronze",
    "Happy",
    "Sad",
    "Angry",
    "Calm",
    "Chill",
    "Wild",
    "Crazy",
    "Mad",
    "Bad",
    "Good",
  ];

  const nouns = [
    "Wolf",
    "Tiger",
    "Lion",
    "Bear",
    "Eagle",
    "Hawk",
    "Falcon",
    "Shark",
    "Whale",
    "Dolphin",
    "Dragon",
    "Phoenix",
    "Griffin",
    "Unicorn",
    "Hydra",
    "Kraken",
    "Titan",
    "Giant",
    "Golem",
    "Robot",
    "Ninja",
    "Samurai",
    "Knight",
    "Wizard",
    "Mage",
    "Warlock",
    "Witch",
    "Sorcerer",
    "Rogue",
    "Hunter",
    "Pilot",
    "Driver",
    "Racer",
    "Gamer",
    "Player",
    "User",
    "Admin",
    "Root",
    "System",
    "Network",
    "Star",
    "Planet",
    "Moon",
    "Sun",
    "Comet",
    "Meteor",
    "Galaxy",
    "Universe",
    "World",
    "Dimension",
  ];

  const prefixes = [
    "The",
    "Mr",
    "Mrs",
    "Ms",
    "Dr",
    "Sir",
    "Lord",
    "Lady",
    "Captain",
    "Commander",
    "iAm",
    "Just",
    "Real",
    "Official",
  ];
  const suffixes = [
    "X",
    "007",
    "99",
    "TV",
    "YT",
    "Live",
    "Pro",
    "God",
    "King",
    "Queen",
    "Master",
    "Zero",
    "One",
  ];

  const categoryData = {
    gaming: [
      "Noob",
      "Pro",
      "Tryhard",
      "Sweat",
      "Carry",
      "Tank",
      "Healer",
      "DPS",
      "Sniper",
      "Camper",
    ],
    aesthetic: [
      "Lofi",
      "Vibe",
      "Dream",
      "Cloud",
      "Soft",
      "Cute",
      "Kawaii",
      "Angel",
      "Devil",
      "Demon",
    ],
    funny: [
      "Potato",
      "Toilet",
      "Trash",
      "Garbage",
      "Dumpster",
      "Muffin",
      "Cookie",
      "Biscuit",
      "Bread",
      "Toast",
    ],
  };

  function generateUsernames(count = 12, baseWord = "", category = "all", useNumbers = true) {
    const results: string[] = [];

    for (let i = 0; i < count; i++) {
      let name = "";
      const r = Math.random();

      // Select random components
      const getRand = (arr: string[]) => arr[Math.floor(Math.random() * arr.length)];

      let adj = getRand(adjectives);
      let noun = getRand(nouns);

      if (category !== "all" && categoryData[category as keyof typeof categoryData]) {
        if (r > 0.5) noun = getRand(categoryData[category as keyof typeof categoryData]);
        else adj = getRand(categoryData[category as keyof typeof categoryData]);
      }

      // Generation patterns
      if (baseWord) {
        if (r < 0.33) name = adj + baseWord;
        else if (r < 0.66) name = baseWord + noun;
        else name = baseWord + getRand(suffixes);
      } else {
        if (r < 0.4) name = adj + noun;
        else if (r < 0.7) name = getRand(prefixes) + noun;
        else name = noun + getRand(suffixes);
      }

      // Add numbers
      if (useNumbers && Math.random() > 0.5) {
        name += Math.floor(Math.random() * 1000);
      }

      // Formatting
      name = name.replace(/\s/g, "");
      results.push(name);
    }

    return results;
  }

  // UI Interaction
  const generateBtn = document.getElementById("generate-btn");
  const resultsGrid = document.getElementById("results-grid");
  const baseWordInput = document.getElementById("base-word") as HTMLInputElement;
  const numbersCheckbox = document.getElementById("use-numbers") as HTMLInputElement;
  const categoryBtns = document.querySelectorAll(".category-btn");

  let currentCategory = "all";

  // Category Selection
  categoryBtns.forEach((btn) => {
    btn.addEventListener("click", () => {
      // Remove active class from all (reset to secondary)
      categoryBtns.forEach((b) => {
        b.classList.remove(
          "bg-blue-600",
          "text-white",
          "hover:bg-blue-500",
          "active:bg-blue-700",
          "shadow-lg",
          "shadow-blue-500/20"
        );
        b.classList.add(
          "bg-white/5",
          "text-white",
          "border",
          "border-white/10",
          "hover:bg-white/10",
          "active:bg-white/20",
          "backdrop-blur-sm"
        );
      });

      // Add active to clicked (switch to primary styles)
      btn.classList.remove(
        "bg-white/5",
        "text-white",
        "border",
        "border-white/10",
        "hover:bg-white/10",
        "active:bg-white/20",
        "backdrop-blur-sm"
      );
      btn.classList.add(
        "bg-blue-600",
        "text-white",
        "hover:bg-blue-500",
        "active:bg-blue-700",
        "shadow-lg",
        "shadow-blue-500/20"
      );

      currentCategory = btn.getAttribute("data-category") || "all";
    });
  });

  // Generate Action
  function runGeneration() {
    const base = baseWordInput.value.trim();
    const useNum = numbersCheckbox.checked;

    const names = generateUsernames(18, base, currentCategory, useNum);

    if (resultsGrid) {
      resultsGrid.innerHTML = "";
      names.forEach((name, index) => {
        const div = document.createElement("div");
        div.className =
          "group flex items-center justify-between p-4 rounded-xl border border-white/5 bg-white/[0.02] hover:bg-blue-500/10 hover:border-blue-500/30 transition-all cursor-pointer animate-in fade-in zoom-in duration-300";
        div.style.animationDelay = `${index * 50}ms`;

        div.innerHTML = `
          <span class="font-mono text-lg font-medium text-slate-200 group-hover:text-blue-300 transition-colors select-all">${name}</span>
          <span class="opacity-0 group-hover:opacity-100 text-[10px] font-bold tracking-tighter text-blue-400 uppercase transition-opacity">Copy</span>
        `;

        div.onclick = () => {
          navigator.clipboard.writeText(name);

          const span = div.querySelector("span:last-child");
          if (span) {
            const originalText = span.textContent;
            span.textContent = "Copied!";
            span.classList.add("text-emerald-400");
            setTimeout(() => {
              span.textContent = originalText;
              span.classList.remove("text-emerald-400");
            }, 1000);
          }
        };

        resultsGrid.appendChild(div);
      });
    }
  }

  generateBtn?.addEventListener("click", runGeneration);
</script>
